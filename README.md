# ğŸŒŠ Bottle Story - ìœ ë¦¬ë³‘ í¸ì§€ ì„œë¹„ìŠ¤

## ğŸ“š ê¸°ìˆ  ìŠ¤íƒ

### ğŸ–¥ Backend
![Java](https://img.shields.io/badge/Java_17-007396?style=for-the-badge&logo=java&logoColor=white)
![Spring Boot](https://img.shields.io/badge/Spring_Boot_3.5.3-6DB33F?style=for-the-badge&logo=spring&logoColor=white)
![MyBatis](https://img.shields.io/badge/MyBatis-006D97?style=for-the-badge&logo=mybatis&logoColor=white)
![Apache Kafka](https://img.shields.io/badge/Apache_Kafka-231F20?style=for-the-badge&logo=apache-kafka&logoColor=white)
![Spring Batch](https://img.shields.io/badge/Spring_Batch-6DB33F?style=for-the-badge&logo=spring&logoColor=white)
![OAuth2](https://img.shields.io/badge/OAuth2-000000?style=for-the-badge&logo=auth0&logoColor=white)

### ğŸ¨ Frontend
![React](https://img.shields.io/badge/React-20232A?style=for-the-badge&logo=react&logoColor=61DAFB)
![Three.js](https://img.shields.io/badge/Three.js-000000?style=for-the-badge&logo=three.js&logoColor=white)

### ğŸ—„ Database
![MySQL](https://img.shields.io/badge/MySQL-4479A1?style=for-the-badge&logo=mysql&logoColor=white)
![Redis](https://img.shields.io/badge/Redis-DC382D?style=for-the-badge&logo=redis&logoColor=white)

### ğŸš€ DevOps
![Kubernetes](https://img.shields.io/badge/Kubernetes-326CE5?style=for-the-badge&logo=kubernetes&logoColor=white)
![Docker](https://img.shields.io/badge/Docker-2CA5E0?style=for-the-badge&logo=docker&logoColor=white)
![VirtualBox](https://img.shields.io/badge/VirtualBox-183A61?style=for-the-badge&logo=virtualbox&logoColor=white)

## ğŸ“– í”„ë¡œì íŠ¸ ê°œìš”

ì ‘ì†ìë“¤ì´ ìµëª…ìœ¼ë¡œ ìì‹ ì˜ ê³ ë¯¼ì´ë‚˜ í•˜ê³  ì‹¶ì€ ë§ì„ ìœ ë¦¬ë³‘ í¸ì§€ë¡œ ë„ì›Œì„œ, ì„¤ì •í•œ ê±°ë¦¬ ë°˜ê²½ì— ë“¤ì–´ìˆëŠ” ë‹¤ë¥¸ ì‚¬ìš©ìì—ê²Œ ì‹¤ì‹œê°„ìœ¼ë¡œ ì „ë‹¬ë˜ëŠ” ê°ì„±ì ì¸ ì†Œí†µ í”Œë«í¼ì…ë‹ˆë‹¤.

### ğŸŒŸ ì£¼ìš” ê¸°ëŠ¥

- **ì‹¤ì‹œê°„ ìœ ë¦¬ë³‘ í¸ì§€**: ì‚¬ìš©ì ìœ„ì¹˜ ê¸°ë°˜ ìœ ë¦¬ë³‘ í¸ì§€ í™•ì‚° ì‹œìŠ¤í…œ
- **3D ëª°ì…í˜• UI**: React Three Fiber ê¸°ë°˜ 3D ë°”ë‹¤ í™˜ê²½
- **ë‚ ì”¨ ì—°ë™ UI**: ì‹¤ì‹œê°„ ë‚ ì”¨ì— ë”°ë¥¸ ë°”ë‹¤, í•˜ëŠ˜, íŒŒí‹°í´ íš¨ê³¼ ìë™ ë³€í™”
- **ì‹œê°„ëŒ€ë³„ ì”¬ ì „í™˜**: ìƒˆë²½ â†’ ì¼ì¶œ â†’ ë‚® â†’ ì¼ëª° â†’ ë°¤
- **ì‹¤ì‹œê°„ ì ‘ì†ì ìˆ˜**: í˜„ì¬ ì ‘ì† ì¤‘ì¸ ì‚¬ìš©ì ìˆ˜ í‘œì‹œ
- **ë‹µê¸€ ì‹¤ì‹œê°„ ì „ì†¡**: WebSocketì„ í†µí•œ ì‹¤ì‹œê°„ ë‹µê¸€ ì• ë‹ˆë©”ì´ì…˜


### 1. ìœ ë¦¬ë³‘ í¸ì§€ë¥¼ ë„ìš°ëŠ” í™”ë©´
![](https://velog.velcdn.com/images/agida0413/post/89b60f0c-8ffb-4b1f-948d-869762a13708/image.png)
### 2.ëˆ„êµ°ê°€ ë‹µì¥ ê¸€ê·€ë¥¼ ì‘ì„±í•˜ì—¬ í•˜ëŠ˜ì— ë‹µì¥ê¸€ê·€ê°€ ëœ¨ëŠ” í™”ë©´
![](https://velog.velcdn.com/images/agida0413/post/661ada84-fe80-4e09-8425-76afe5ae2d71/image.png)

### 3.ì¼ì¶œ ì‹œê°„ì´ ë˜ì–´ UIê°€ ë³€ê²½ë˜ëŠ” ìƒí™©
![](https://velog.velcdn.com/images/agida0413/post/9a2fbf0c-937c-4d6c-b4b6-064f2adab476/image.png)




### 4. ë‹µì¥ ê¸€ê·€ë¥¼ ì‘ì„±í•˜ëŠ” ìƒí™©

![](https://velog.velcdn.com/images/agida0413/post/bdafb5ca-3dd8-4f09-99f3-4598072850d5/image.gif)

### 5. ë‹µì¥ê¸€ê·€ê°€ ì¶œë ¥ë˜ëŠ” ìƒí™©

![](https://velog.velcdn.com/images/agida0413/post/f560704b-5da5-439d-bb33-65f574b50f0c/image.gif)

### 6. ìƒˆë¡œìš´ ìœ ë¦¬ë³‘ì„ ë„ìš°ëŠ” ìƒí™©
![](https://velog.velcdn.com/images/agida0413/post/0963104e-94ed-4efa-b8a2-07a9a259e59d/image.gif)


## ğŸ— ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### MSA ì„œë¹„ìŠ¤ êµ¬ì„±

| ì„œë¹„ìŠ¤ | ì—­í•  | ì£¼ìš” ê¸°ìˆ  |
|--------|------|-----------|
| **Member Service** | OAuth2 ê¸°ë°˜ ì¸ì¦/ì¸ê°€, ì ‘ì†ì ìˆ˜ ê´€ë¦¬, ìœ„ì¹˜ ê¸°ë°˜ ë§¤ì¹­ | Spring Security, OAuth2, JWT |
| **Weather-BGM Service** | ê¸°ìƒì²­ API ì—°ë™, Scene ì´í™íŠ¸ ê²°ì • | WebClient, ì™¸ë¶€ API ì—°ë™ |
| **Batch Service** | ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘, ì„¸ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬, í†µê³„ ì²˜ë¦¬ | Spring Batch |
| **Realtime Service** | WebSocket ì—°ê²° ê´€ë¦¬, ì‹¤ì‹œê°„ í‘¸ì‹œ, ì‚¬ìš©ì ìœ„ì¹˜ ìˆ˜ì§‘ | STOMP, SockJS |
| **Bottle Service** | ìœ ë¦¬ë³‘ í¸ì§€ CRUD, ì¢Œí‘œ ì´ë™ ë¡œì§, ì†Œë©¸ ê·œì¹™ ê´€ë¦¬ | Redis GEO |

### ì´ë²¤íŠ¸ ê¸°ë°˜ ì•„í‚¤í…ì²˜
- **Kafka** ê¸°ë°˜ ë¹„ë™ê¸° ë©”ì‹œì§€ ì²˜ë¦¬
- ì„œë¹„ìŠ¤ ê°„ ëŠìŠ¨í•œ ê²°í•©ìœ¼ë¡œ í™•ì¥ì„± ë³´ì¥
- ì´ë²¤íŠ¸ ìƒíƒœ ì¶”ì ì„ í†µí•œ ì•ˆì •ì„± í™•ë³´

## ğŸ’¾ Redis í‚¤ ê´€ë¦¬

| í‚¤ ì´ë¦„ | ë°ì´í„° íƒ€ì… | ìš©ë„ | TTL |
|---------|------------|------|-----|
| `WS_SESSIONS` | Sorted Set | ì›¹ì†Œì¼“ ì„¸ì…˜ ìƒëª…ì£¼ê¸° ê´€ë¦¬ | 5ë¶„ |
| `GEO:MEMBER` | GEO | ì‹¤ì‹œê°„ ì‚¬ìš©ì ìœ„ì¹˜ ì €ì¥ | - |
| `GEO:BOTTLE` | GEO | ìœ ë¦¬ë³‘ í¸ì§€ ìœ„ì¹˜ ì €ì¥ | - |
| `refresh:{userId}` | String | Refresh í† í° ì €ì¥ | 7ì¼ |
| `blacklist:{token}` | String | ë¸”ë™ë¦¬ìŠ¤íŠ¸ í† í° ì €ì¥ | 7ì¼ |
| `CM_*_CODE` | Hash | ê³µí†µ ì½”ë“œ ê´€ë¦¬ (ìƒíƒœ, ë‚ ì”¨, íŒŒí‹°í´ ë“±) | - |

### GEO íƒ€ì… í™œìš©
```java
// ì‚¬ìš©ì ìœ„ì¹˜ ì €ì¥
redisTemplate.opsForGeo().add(RedisKey.GEO_MEMBER, 
    new GeoLocation<>(userId, new Point(longitude, latitude)));

// ë°˜ê²½ 10km ë‚´ ìœ ë¦¬ë³‘ ê²€ìƒ‰
Circle circle = new Circle(userPoint, new Distance(10.0, Metrics.KILOMETERS));
List<String> nearbyBottles = redisTemplate.opsForGeo().radius(RedisKey.GEO_BOTTLE, circle);
```

## ğŸ¯ í•µì‹¬ ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§

### ìœ ë¦¬ë³‘ í¸ì§€ í”Œë¡œìš°
1. ì‚¬ìš©ìê°€ ìœ ë¦¬ë³‘ í¸ì§€ë¥¼ ì‘ì„±í•˜ì—¬ ë°”ë‹¤ì— ë„ì›€
2. í¸ì§€ëŠ” ê°€ê¹Œìš´ ì‚¬ëŒì—ê²Œ ë¨¼ì € ë…¸ì¶œë¨
3. ë°œê²¬í•œ ì‚¬ìš©ìëŠ” **í˜ë ¤ë³´ë‚´ê¸°** ë˜ëŠ” **ë‹µê¸€ ì‘ì„±** ì„ íƒ
4. **í˜ë ¤ë³´ë‚´ê¸°**: 10km ë²”ìœ„ ë‚´ ëœë¤ ìœ„ì¹˜ë¡œ ì´ë™í•˜ì—¬ ë” ë¨¼ ì‚¬ëŒì—ê²Œ í™•ì‚°
5. **ë‹µê¸€ ì‘ì„±**: í¸ì§€ ì†Œë©¸ í›„ ì›ì‘ì„±ìì—ê²Œ ì‹¤ì‹œê°„ ì• ë‹ˆë©”ì´ì…˜ìœ¼ë¡œ ì „ë‹¬

### ì‹¤ì‹œê°„ ë°ì´í„° ìˆ˜ì§‘
- **ë‚ ì”¨ ë°ì´í„°**: ê¸°ìƒì²­ API 30ë¶„ë§ˆë‹¤ ë°°ì¹˜ ìˆ˜ì§‘
- **ì¼ì¶œ/ì¼ëª° ë°ì´í„°**: sunrise-sunset.org API ì¼ë³„ ìˆ˜ì§‘
- **AI BGM**: ë‚ ì”¨ + ì‹œê°„ëŒ€ ì¡°í•©ìœ¼ë¡œ ë§ì¶¤ ë°°ê²½ìŒì•… ì¶”ì²œ

### ì‹œê°„ëŒ€ë³„ Scene ì½”ë“œ ì‚°ì¶œ
```
ìƒˆë²½ (Pre-dawn): now < sunrise
ì¼ì¶œ (Sunrise): sunrise â‰¤ now < sunrise + 60ë¶„
ë‚® (Daytime): sunrise + 60ë¶„ â‰¤ now < sunset - 30ë¶„
ì¼ëª° (Sunset): sunset - 30ë¶„ â‰¤ now < sunset
ë°¤ (Night): now â‰¥ sunset
```

## ğŸš€ ê°œë°œ í™˜ê²½ ë° ë°°í¬

### ë¡œì»¬ ê°œë°œí™˜ê²½
- **VirtualBox** ê¸°ë°˜ VM í´ëŸ¬ìŠ¤í„°
- **VPN** ì„ í†µí•œ ê°œë°œí™˜ê²½ ë„¤íŠ¸ì›Œí¬ êµ¬ì¶•
- **Docker Compose** ë¥¼ í†µí•œ ë¡œì»¬ ì„œë¹„ìŠ¤ ê´€ë¦¬

### CI/CD íŒŒì´í”„ë¼ì¸
- **Kubernetes** ê¸°ë°˜ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜
- **DEV/PRD** í™˜ê²½ ë¶„ë¦¬ ìš´ì˜
- ìë™í™”ëœ ë¹Œë“œ ë° ë°°í¬ í”„ë¡œì„¸ìŠ¤

## ğŸ“Š ë°ì´í„° ëª¨ë¸ë§

### ì£¼ìš” ì—”í‹°í‹°
- **MEMBER**: ì‚¬ìš©ì ì •ë³´ ë° OAuth2 ì—°ë™ ë°ì´í„°
- **BOTTLE_LETTER**: ìœ ë¦¬ë³‘ í¸ì§€ ë‚´ìš© ë° ìƒíƒœ ê´€ë¦¬
- **WEATHER_BGM**: ë‚ ì”¨ íˆìŠ¤í† ë¦¬ ë° Scene ì½”ë“œ ê´€ë¦¬
- **COMMON_CODE**: ì‹œìŠ¤í…œ ê³µí†µ ì½”ë“œ ê´€ë¦¬

## ğŸ® ì‚¬ìš©ì ê²½í—˜

### UI/UX íŠ¹ì§•
- **3D ë°”ë‹¤ í™˜ê²½**: React Three Fiberë¡œ êµ¬í˜„ëœ ëª°ì…ê° ìˆëŠ” UI
- **ë‚ ì”¨ ë°˜ì‘í˜• UI**: ì‹¤ì‹œê°„ ë‚ ì”¨ì— ë”°ë¥¸ ë°”ë‹¤/í•˜ëŠ˜/íŒŒí‹°í´ íš¨ê³¼ ë³€í™”
- **ê°ì„±ì  ì• ë‹ˆë©”ì´ì…˜**: ë‹µê¸€ ìˆ˜ì‹  ì‹œ ë°”ë‹¤ì—ì„œ í•˜ëŠ˜ë¡œ ì˜¬ë¼ê°€ëŠ” í…ìŠ¤íŠ¸ ì• ë‹ˆë©”ì´ì…˜
- **ì§ê´€ì  ì¸í„°ë™ì…˜**: ìœ ë¦¬ë³‘ í´ë¦­ìœ¼ë¡œ í¸ì§€ í™•ì¸, ê°„ë‹¨í•œ ë‹µê¸€ ì‘ì„±

### ì‹¤ì‹œê°„ ê¸°ëŠ¥
- **WebSocket**: STOMP í”„ë¡œí† ì½œ ê¸°ë°˜ ì‹¤ì‹œê°„ ì–‘ë°©í–¥ í†µì‹ 
- **ì ‘ì†ì ìˆ˜**: ì‹¤ì‹œê°„ ì˜¨ë¼ì¸ ì‚¬ìš©ì ìˆ˜ í‘œì‹œ
- **ìœ„ì¹˜ ì¶”ì **: ì‚¬ìš©ì ë™ì˜ í•˜ì— ì‹¤ì‹œê°„ ìœ„ì¹˜ ì •ë³´ ìˆ˜ì§‘
- **ìƒëª…ì£¼ê¸° ê´€ë¦¬**: ì§€ìˆ˜ ë°±ì˜¤í”„ ì „ëµì„ í†µí•œ ì•ˆì •ì ì¸ ì—°ê²° ê´€ë¦¬

## ğŸ”§ ê¸°ìˆ ì  ë„ì „ê³¼ í•´ê²°

### ì„±ê³¼
- **MSA êµ¬ì¡°**ì—ì„œ ë©”ì‹œì§• íë¥¼ í†µí•œ ì„œë¹„ìŠ¤ ê°„ í†µì‹  êµ¬í˜„
- **Kafka** ë¸Œë¡œë“œìºìŠ¤íŒ…ì„ í†µí•œ ì‹¤ì‹œê°„ ì´ë²¤íŠ¸ ì²˜ë¦¬
- **Kubernetes** í´ëŸ¬ìŠ¤í„° êµ¬ì¶• ë° VM í™˜ê²½ ê´€ë¦¬
- **ê°œë°œí™˜ê²½ ë„¤íŠ¸ì›Œí¬** êµ¬ì¶• (VPN)

### í–¥í›„ ê°œì„  ì‚¬í•­
- **Saga íŒ¨í„´** ì ìš©ì„ í†µí•œ ë¶„ì‚° íŠ¸ëœì­ì…˜ ê´€ë¦¬
- **CQRS íŒ¨í„´** ë„ì…ìœ¼ë¡œ ì½ê¸°/ì“°ê¸° ì„±ëŠ¥ ìµœì í™”
- **ë°ì´í„° ì •í•©ì„±** ë³´ì¥ì„ ìœ„í•œ ì¶”ê°€ì ì¸ ì•„í‚¤í…ì²˜ ê°œì„ 

